<nav>
    <div class="navbar-nav">
        <a class="nav-link active" href="/home">Productos</a>
        <a class="nav-link cart" href="/api/carts/{{user.cart._id}}">Carrito</a>
        <a class="nav-link" href="/chat">Chat</a>
        <a class="nav-link" href="/auth/logout">Logout</a>
    </div>
</nav>

<div class="container">
    <h1 class="text-center">By Sof - Products</h1>

    <div class="productsContainer">
        {{#each products}}
            <div class="mb-3 w-50">
                <div class="card">
                    <h5 class="card-header text-center"> {{this.title}} </h5>
                    <img class="card-image" src="{{this.thumbnail}}" alt="{{this.title}}">
                    <div class="card-body text-center"> 
                        <em class="card-title"> {{this.description}} </em>
                        <p class="card-text text-center"> <b> ${{this.price}} </b>  </p>
                        <small class="d-block">id: {{this._id}} </small>
                        <div class="mb-3 text-center">
                            <input type="number" id="quantityInput" class="quantityInput form-control-sm" max={{this.stock}} min="1" value="1"/>
                        </div>
                        <a href="/api/products/{{this._id}}">Ver producto</a>
                    </div>
                </div>
            </div>
        {{/each}}   
    </div>
        {{#if pagination.hasPrevPage}}
            <a class="btn btn-outline-info m-2" style='font-size: 20;' href='/home/?page={{pagination.prevPage}}'>⬅{{pagination.prevPage}}</a>
        {{/if}}
            <a class="btn btn-outline-info m-2" style='font-size: 20;' href='#'>{{pagination.page}}</a>
        {{#if pagination.hasNextPage}}
            <a class="btn btn-outline-info m-2"style='font-size: 20;' href='/home/?page={{pagination.nextPage}}'>{{pagination.nextPage}}➡</a>
        {{/if}}
            <br/>
            <br/>
</div>

<script src="../public/cart.js"></script>

    {{!-- btnAdd.addEventListener('click', async () => {
        const prodId = btnAdd.dataset.id
        console.log('ID producto:', prodId)
        const cart = await getCart()
        
        try{
            const res = await fetch(`/api/carts/${cart}/products/${prodId}`, {
                method: 'POST',
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({quantity: quantity.value})
            })
            const data = await res.json()
            console.log('Product added to cart', data)
        }catch(err){
            console.log('Error adding product to cart', err)
        }

    }) --}}